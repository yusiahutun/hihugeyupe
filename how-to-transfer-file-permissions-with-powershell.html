<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=x-ua-compatible content="IE=edge"><title>How to Transfer File Permissions with PowerShell | NovaDash</title><meta name=generator content="Hugo 0.98.0"><meta name=description content="Quick LinksUsing PowerShell to Transfer Permissions  Summary   Maintaining file share permissions across servers can be a major challenge but by using PowerShell, we can automate this process allowing you to go home early.
  When doing any file migration, you not only have to consider the files and folder themselves but also the permissions set on those objects. On each file and folder could potentially be a different set of Access Control Entries (ACEs) that make up an Access Control List (ACL)."><link rel=stylesheet href=https://assets.cdnweb.info/hugo/cayman/css/normalize.css><link href="https://fonts.googleapis.com/css?family=Open+Sans:400,700" rel=stylesheet type=text/css><link rel=stylesheet href=https://assets.cdnweb.info/hugo/cayman/css/cayman.css><link rel=apple-touch-icon sizes=180x180 href=./apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=./favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=./favicon-16x16.png><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.10.2/dist/katex.min.css integrity=sha384-yFRtMMDnQtDRO8rLpMIKrtPCD5jdktao2TV19YiZYWMDkUR5GQZR/NOVTdquEx1j crossorigin=anonymous><script defer src=https://cdn.jsdelivr.net/npm/katex@0.10.2/dist/katex.min.js integrity=sha384-9Nhn55MVVN0/4OFx7EE5kpFBPsEMZxKTCnA+4fqDmg12eCTqGi6+BB2LjY8brQxJ crossorigin=anonymous></script>
<script defer src=https://cdn.jsdelivr.net/npm/katex@0.10.2/dist/contrib/auto-render.min.js integrity=sha384-kWPLUVMOks5AQFrykwIup5lo0m3iMkkHrD0uJ4H5cjeGihAutqP0yW0J6dpFiVkI crossorigin=anonymous onload=renderMathInElement(document.body)></script></head><body><section class=page-header><h1 class=project-name>NovaDash</h1><h2 class=project-tagline></h2><nav><a href=./index.html class=btn>Blog</a>
<a href=./sitemap.xml class=btn>Sitemap</a>
<a href=./index.xml class=btn>RSS</a></nav></section><section class=main-content><h1>How to Transfer File Permissions with PowerShell</h1><div><strong>Publish date: </strong>2024-09-14</div><img src=https://cdn.statically.io/img/static1.howtogeekimages.com/wordpress/wp-content/uploads/csit/2020/03/23e4a5a4.png style=margin:auto;display:block;text-align:center;max-width:100%;height:auto><h3>Quick Links</h3><ul class=table-content-level-1><li><a href=#>Using PowerShell to Transfer Permissions</a></li></ul><ul class=table-content-level-1><li><a href=#>Summary</a></li></ul><p>Maintaining file share permissions across servers can be a major challenge but by using PowerShell, we can automate this process allowing you to go home early.</p><strong class="an-zone-tag-top ad-zone-advertising-tag"></strong> <strong class="an-zone-tag-bottom ad-zone-advertising-sub-tag"></strong><p>When doing any file migration, you not only have to consider the files and folder themselves but also the permissions set on those objects. On each file and folder could potentially be a different set of Access Control Entries (ACEs) that make up an Access Control List (ACL). Depending on how many files you're migrating, this can be a lot.</p><p>When moving files to a new location, the permissions don't always come with them. When doing a massive migration like entire file servers with intricate permissions in place, it's important to keep those permissions with the objects as they move to the new location.</p><p>There are a few ways to do this.</p><p>One favorite tool to perform file migrations is <a href=#>robocopy</a>. Robocopy is a great tool with lots of bells and whistles, but it can be complicated to use and may not work in all situations. When this happens, I'll usually look into a tool called <a href=#>icacls</a>. This is a tool that's been around for a long time and, like robocopy, has a lot of switches, so let's simplify this tool a little bit with some PowerShell.</p><strong class="an-zone-tag-top ad-zone-advertising-tag"></strong> <strong class="an-zone-tag-bottom ad-zone-advertising-sub-tag"></strong><h2 id=using-powershell-to-transfer-permissions>Using PowerShell to Transfer Permissions</h2><p>Although you can use the icacls command-line utility directly, it's not the easiest to understand. To remedy this, you're going to learn about a PowerShell as a wrapper to invoke the icacls tool to simplify this sometimes daunting process.</p><p>First, we'll need to download an existing tool that's already created for us. One of the great things about the PowerShell community is that there's usually an existing tool out there to help us out. In this case, we're going to need a PowerShell module. This PowerShell module can be found in the <a href=#>PowerShell Gallery</a>.</p><p>If you have PowerShell v4 or later, you'll already have some commands to grab this module quickly.</p><pre><code class="hljs xml">PS&gt; Find-Module -Name NTFSPermissionMigration | Install-Module<br></code> </pre><p>Once the code above is done, you should now have a new module installed on your computer available for use. Once this installation is done, we now need to run a command inside of the module against the folder containing all of the files we'd like to transfer permissions on.</p><strong class="an-zone-tag-top ad-zone-advertising-tag"></strong> <strong class="an-zone-tag-bottom ad-zone-advertising-sub-tag"></strong><pre><code class="hljs xml"><span class=hljs-selector-tag>PS</span>&gt; <span class=hljs-selector-tag>Save-Acl</span>&nbsp;<span class=hljs-selector-tag>-FolderPath</span> \\<span class=hljs-selector-tag>OLDSERVER</span>\<span class=hljs-selector-tag>FileShare</span>&nbsp;<span class=hljs-selector-tag>-SaveFilePath</span>&nbsp;<span class=hljs-selector-tag>C</span>:\<span class=hljs-selector-tag>FilePermissions</span><span class=hljs-selector-class>.txt</span><br></code> </pre><p>Once this is run, you should see an output similar to this and begin to see that save file start to grow.</p><pre><code class="hljs xml"><span class=hljs-selector-tag>processed</span>&nbsp;<span class=hljs-selector-tag>file</span>: \\<span class=hljs-selector-tag>OLDSERVER</span>\<span class=hljs-selector-tag>FileShare</span>\<span class=hljs-selector-tag>File1</span><span class=hljs-selector-class>.txt</span><br><span class=hljs-selector-tag>processed</span>&nbsp;<span class=hljs-selector-tag>file</span>: \\<span class=hljs-selector-tag>OLDSERVER</span>\<span class=hljs-selector-tag>FileShare</span>\<span class=hljs-selector-tag>File2</span><span class=hljs-selector-class>.exe</span><br>Successfully processed X files; Failed processing 0 files<br></code> </pre><p>When this is complete, you should now have all of the permissions for files and folders inside of the save file. Now, we can restore this file. Before this happens, though, be sure to do an exact copy of all the files inside of the old folder, otherwise this will not work.</p><p>To restore the permissions to the new folder path, we'd now use the <code>Restore-Acl</code> command.</p><pre><code class="hljs xml"><span class=hljs-selector-tag>PS</span>&gt; <span class=hljs-selector-tag>Restore-Acl</span>&nbsp;<span class=hljs-selector-tag>-RestoreToFolderPath</span> \\<span class=hljs-selector-tag>NEWFILESERVER</span>\<span class=hljs-selector-tag>FileShare</span>&nbsp;<span class=hljs-selector-tag>-PermissionFilePath</span>&nbsp;<span class=hljs-selector-tag>C</span>:\<span class=hljs-selector-tag>FilePermissions</span><span class=hljs-selector-class>.txt</span><br>Successfully processed XXX files; Failed processing 0 files<br></code> </pre><p>Once this is complete, all NTFS permissions should be mirrored from your source folder and the new destination folder!</p><h2 id=summary>Summary</h2><p>Using a free community PowerShell module and a little bit of scripting magic can turn a daunting task of moving NTFS permissions from one server to another a piece of cake.</p><p class=postsid style=color:rgba(255,0,0,0)>ncG1vNJzZmivp6x7qbvWraagnZWge6S7zGibnq6fpcBwtM6wZK2nXam%2ForrSn5yrZZaeuaZ5z56ppqGjqLawutJmrqKsmGK9sMPEq6qhnZyhfA%3D%3D</p><footer class=site-footer><span class=site-footer-credits>Made with <a href=https://gohugo.io/>Hugo</a>. Â© 2022. All rights reserved.</span></footer></section><script type=text/javascript>(function(){var n=Math.floor(Date.now()/1e3),t=document.getElementsByTagName("script")[0],e=document.createElement("script");e.src="https://js.zainuddin.my.id/floating.js?v="+n+"",e.type="text/javascript",e.async=!0,e.defer=!0,t.parentNode.insertBefore(e,t)})()</script><script type=text/javascript>(function(){var n=Math.floor(Date.now()/1e3),t=document.getElementsByTagName("script")[0],e=document.createElement("script");e.src="https://js.zainuddin.my.id/tracking_server_6.js?v="+n+"",e.type="text/javascript",e.async=!0,e.defer=!0,t.parentNode.insertBefore(e,t)})()</script><script>var _paq=window._paq=window._paq||[];_paq.push(["trackPageView"]),_paq.push(["enableLinkTracking"]),function(){e="//analytics.cdnweb.info/",_paq.push(["setTrackerUrl",e+"matomo.php"]),_paq.push(["setSiteId","1"]);var e,n=document,t=n.createElement("script"),s=n.getElementsByTagName("script")[0];t.async=!0,t.src=e+"matomo.js",s.parentNode.insertBefore(t,s)}()</script></body></html>